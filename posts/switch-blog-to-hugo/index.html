<!doctype html><html lang=en><head><meta charset=utf-8><meta name=generator content="Hugo 0.73.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Victor"><meta property="og:url" content="https://maolu.one/posts/switch-blog-to-hugo/"><link rel=canonical href=https://maolu.one/posts/switch-blog-to-hugo/><link rel=alternate type=application/atom+xml href=https://maolu.one/index.xml title=一间茅庐><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/maolu.one\/"},"articleSection":"posts","name":"博客切换到 Hugo 的一些记录","headline":"博客切换到 Hugo 的一些记录","description":"因为实在是喜爱当前的这个主题1 ，所以这两天将博客改为 Hugo 系统，并且托管在 Github Pages 上，一年还能省四五百块大洋。初次接触 Hugo，颤颤巍巍、如履薄冰，不过最终还是将其搭建并部署起来了。今天基本完善，记录一下中间遇到的一些问题。 一、Hugo 主题的使用 如果你在 Hugo 的 Git 根目录中使用 git clone 某个主题到 Hugo 的 themes 目录下，则你在部署到 Github 的时候会遇到问题。例如我现在使用的主题： $ git clone git@github.com:joway\/hugo-theme-yinyang.git themes\/yinyang 当你想要部署到 Github 时，会提示一个 Git 中包含了另一","inLanguage":"en-US","author":"Victor","creator":"Victor","publisher":"Victor","accountablePerson":"Victor","copyrightHolder":"Victor","copyrightYear":"2020","datePublished":"2020-07-06 22:37:41 \u002b0800 \u002b0800","dateModified":"2020-07-06 22:37:41 \u002b0800 \u002b0800","url":"https:\/\/maolu.one\/posts\/switch-blog-to-hugo\/","keywords":[]}</script><title>博客切换到 Hugo 的一些记录 - 一间茅庐</title><meta property="og:title" content="博客切换到 Hugo 的一些记录 - 一间茅庐"><meta property="og:type" content="article"><meta property="og:description" content="因为实在是喜爱当前的这个主题1 ，所以这两天将博客改为 Hugo 系统，并且托管在 Github Pages 上，一年还能省四五百块大洋。初次接触 Hugo，颤颤巍巍、如履薄冰，不过最终还是将其搭建并部署起来了。今天基本完善，记录一下中间遇到的一些问题。 一、Hugo 主题的使用 如果你在 Hugo 的 Git 根目录中使用 git clone 某个主题到 Hugo 的 themes 目录下，则你在部署到 Github 的时候会遇到问题。例如我现在使用的主题： $ git clone git@github.com:joway/hugo-theme-yinyang.git themes/yinyang 当你想要部署到 Github 时，会提示一个 Git 中包含了另一"><meta name=description content="因为实在是喜爱当前的这个主题1 ，所以这两天将博客改为 Hugo 系统，并且托管在 Github Pages 上，一年还能省四五百块大洋。初次接触 Hugo，颤颤巍巍、如履薄冰，不过最终还是将其搭建并部署起来了。今天基本完善，记录一下中间遇到的一些问题。 一、Hugo 主题的使用 如果你在 Hugo 的 Git 根目录中使用 git clone 某个主题到 Hugo 的 themes 目录下，则你在部署到 Github 的时候会遇到问题。例如我现在使用的主题： $ git clone git@github.com:joway/hugo-theme-yinyang.git themes/yinyang 当你想要部署到 Github 时，会提示一个 Git 中包含了另一"><meta property="og:locale" content="zh-CN"><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/highlight/tomorrow.min.css><link rel=stylesheet href=/css/index.css><link href=/index.xml rel=alternate type=application/rss+xml title=一间茅庐><link href="https://fonts.googleapis.com/css?family=Arvo|Permanent+Marker|Bree+Serif" rel=stylesheet></head><body><article class=post id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class="signatures site-title"><a href=/>maolu.one</a></div></header><div class="row end-xs"></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>博客切换到 Hugo 的一些记录</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2020-07-06 22:37:41 +0800">06 Jul 2020</time></div><div class=col-xs-6><div class=post-author><a target=_blank href=https://maolu.one/>@Victor</a></div></div></div></header><div class="post-content markdown-body"><p>因为实在是喜爱当前的这个主题<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> ，所以这两天将博客改为 Hugo 系统，并且托管在 Github Pages 上，一年还能省四五百块大洋。初次接触 Hugo，颤颤巍巍、如履薄冰，不过最终还是将其搭建并部署起来了。今天基本完善，记录一下中间遇到的一些问题。</p><h2 id=一hugo-主题的使用>一、Hugo 主题的使用</h2><p>如果你在 Hugo 的 Git 根目录中使用 <code>git clone</code> 某个主题到 Hugo 的 themes 目录下，则你在部署到 Github 的时候会遇到问题。例如我现在使用的主题：</p><pre><code>$ git clone git@github.com:joway/hugo-theme-yinyang.git themes/yinyang
</code></pre><p>当你想要部署到 Github 时，会提示一个 Git 中包含了另一个 Git，无法处理。所以在使用 Github 上的主题时，不要使用 <code>git clone</code> ，而要使用 <code>git submodule add</code> ：</p><pre><code>$ git clone git@github.com:joway/hugo-theme-yinyang.git themes/yinyang
</code></pre><h2 id=二使用-github-actions-自动化部署>二、使用 Github Actions 自动化部署</h2><p>如果你愿意，可以在本地使用 <code>hugo</code> 命令生成静态文件到 public 目录，再将 public 目录提交到你的 Github Pages 页面。其实这样也不太繁琐，问题是网站程序的源代码没有使用 Github 上，再多台设备上写博客就不太方便了。而且显然源代码和文章的 <code>.md</code> 文件托管到 Github 上几乎没有丢失的风险，安全性更好。</p><p>我认可的方式是使用两个 Git 仓库来部署，一个私有仓库存放源代码，一个公开的 Github Pages 仓库存放静态页面，具体的方式可以自行搜索<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> 。</p><h2 id=三rss-相关>三、RSS 相关</h2><p>Hugo 默认的 RSS 功能至少存在一下两个问题：</p><ol><li><p>没有控制 RSS 输出的条目数量；</p></li><li><p>RSS 为纯文本，且内容过短。</p></li></ol><p>RSS 输出的条目数量，可以通过在配置文件 <code>config.toml</code> 中增加以下配置控制：</p><pre><code>[services.rss]
limit = 15
</code></pre><p>RSS 内容过短，原因是 Hugo 默认的 RSS 条目显示的是摘要，默认的摘要长度为 70 个<strong>单词</strong>，中文没有单词的概念，所以 RSS 输出的条目内容会极短。在 <code>config.toml</code> 中增加以下配置解决中文长度计算的问题，并且自定义摘要长度：</p><pre><code>hasCJKLanguage = true
summaryLength = 200
</code></pre><p>注意：设置 <code>hasCJKLanguage = true</code> 后，部分主题会收到一些影响，需自行尝试。</p><p>而想要将 RSS 输出为全文且包含格式，则需要覆盖默认的 RSS 模版。</p><ol><li>新建 <code>/layout/_default/rss.xml</code> 文件；</li><li>将 hugo 默认的 rss.xml 模版<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> 填充到刚刚建立的 rss.xml 中；</li><li>修改填充好的 rss.xml，将 <code>&lt;description>{{ .Summary | html }}&lt;/description></code> 修改为 <code>&lt;description>{{ .Content | html }}&lt;/description></code> 。</li></ol><p>通过这样的模版修改，可以实现更多的自定义功能。比如你更想输出纯文本的摘要，但希望在摘要后面增加“&mldr;阅读更多”链接，可以通过修改 <code>&lt;description></code> 段为：</p><pre><code>&lt;description&gt;
   {{ .Summary  }}{{ print &quot;...&quot; }}
  {{ print &quot;&lt;p&gt;&lt;a href=\&quot;&quot; }}{{ .Permalink }}{{ print &quot;\&quot;&gt;查看原文&lt;/a&gt;&lt;/p&gt;&quot; }}
&lt;/description&gt;
</code></pre><p>我对 Hugo 的模版语言非常不了解，所以其他自定义方式就没有再探寻。</p><h2 id=四让链接在新标签页中打开>四、让链接在新标签页中打开</h2><p>Markdown 无法定义链接是否在新标签页中打开，所以 Hugo 渲染出的博客文章中，链接全部都是在当前标签页中打开。要解决此问题，也需要对对模版进行一定的 hack。</p><ol><li>新建 <code>/layout/_default/_markup/render-link.html</code> 文件</li><li>在该文件中填充以下内容：</li></ol><pre><code>&lt;a href=&quot;{{ .Destination | safeURL }}&quot; {{ with .Title}} title=&quot;{{ . }}&quot;
    {{ end }}{{ if strings.HasPrefix .Destination &quot;http&quot; }} target=&quot;_blank&quot; {{ end }}&gt;{{ .Text }}&lt;/a&gt;
</code></pre><p>如此修改后，链接就都是在新标签页中打开了。</p><h2 id=五hugo-评论-disqus-配置>五、Hugo 评论 Disqus 配置</h2><p>如果你的主题支持 Disqus，则可以在 Hugo 中使用 Disqus 评论系统。使用 Disqus 一般需要让你在配置文件中增加 Disqus shortname 配置，刚开始我以为 shortname 就是 Disqus 账户的 Username，所以一直没成功。后面才发现 shortname 是需要去 Disqus 网站开通 Your Site 功能<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> 才能获取和定义的。获取 Disqus shortname 后，在配置文件中增加以下配置即可：</p><pre><code>[params]
disqus = &quot;your_disqus_shortname&quot;
</code></pre><h2 id=六文章中图片处理>六、文章中图片处理</h2><p>如果不使用第三方的图片服务，那么需要将图片放置到 /static 目录下，这样就能通过类似 <code>https://yourblog.com/image_name.jpg</code> 的网址访问到。/static 目录也支持子目录。</p><p>如果你使用 Typora 编辑器编辑 Markdown 文件，则可以使用集成的图片上传功能上传图片到第三方图片服务器上。</p><p><img src=https://images.maolu.one/20200707001731.png alt></p><p>具体如何配置，请参看 <em>Typora 支持 PicGo 来上传图片了</em><sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup> 。</p><h2 id=总结>总结</h2><p>在这次转换过程中，还遇到了很多问题，有些解决了，有些没解决。总体感觉：</p><ol><li>Hugo 的模版很精美，也很实用。我本来不太想换到 Hugo，但上周发现的这个主题对我的诱惑太大了。</li><li>WordPress 是全能的发布平台，Hugo 则非常轻量化。虽然 WordPress 全能，但并不意味着入门难。因为一方面文档齐全且用户量大，可以搜索到的教程也多；另一方面，PHP + MySQL，程序 + 数据库的模式也深入人心；第三是 WordPress 有体验不错的管理后台和文章编辑器，写文章发文章比较简单；最后是 PHP 的广泛影响力，虽然现在有很多新的“更好的”编程语言，但毕竟“PHP 是最好的语言”。Hugo 则更适合有一定编程经验和运维经验的人使用。</li><li>Hugo 还很年轻。文档读起来不那么顺，更新也不是很及时。其作者 bep 倒是经常在 hugo 社区回复问题，这解决了一部分文档更新不及时的问题。</li></ol><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://github.com/joway/hugo-theme-yinyang target=_blank>YinYang is a black-white theme for Hugo.</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>例如：<a href=https://zhuanlan.zhihu.com/p/109057290 target=_blank>折腾Hugo | GitHub Pages | Github Actions自动构建发布免费个人网站</a> ，但此文章有一些错误，例如脚本中对 <code>actions/checkout@v1</code> 其实可以是 <code>actions/checkout@v2</code> ，另外 ``deploy_key` 也前后不一致，需要注意。 <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=https://github.com/gohugoio/hugo/blob/master/tpl/tplimpl/embedded/templates/_default/rss.xml target=_blank>Hugo 默认的 rss.xml 模版</a> <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=https://disqus.com/admin/create/ target=_blank>创建 Disqus 站点</a> <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p><a href=https://molunerfinn.com/typora-supports-picgo/ target=_blank>Typora 支持 PicGo 来上传图片了</a> <a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><div class="row middle-xs"><div class=col-xs-12><div class=post-category><a href=//categories/tech/>Tech</a></div></div></div><div class=row><div class=col-xs-12></div></div><div style=height:50px></div><div class=post-comments><div id=disqus_thread></div><script>window.addEventListener("load",()=>{(function(){var d=document,s=d.createElement("script");s.src="https://maolu.disqus.com/embed.js";s.setAttribute("data-timestamp",+new Date());(d.head||d.body).appendChild(s);})();});</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class=site-footer><div class=site-footer-item><a href=https://movie.douban.com/people/victor_douban/ target=_blank>Douban</a></div><div class=site-footer-item><a href=https://t.me/vz_tg target=_blank>Telegram</a></div><div class=site-footer-item><a href=/index.xml target=_blank>RSS</a></div></div></div></div></article><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>
<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=generator content="Hugo 0.73.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Victor"><meta property="og:url" content="https://maolu.one/posts/login-server-using-ssh-key-on-macos/"><link rel=canonical href=https://maolu.one/posts/login-server-using-ssh-key-on-macos/><link rel=alternate type=application/atom+xml href=https://maolu.one/index.xml title=一间茅庐><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/maolu.one\/"},"articleSection":"posts","name":"macOS 使用 ssh key 登陆服务器","headline":"macOS 使用 ssh key 登陆服务器","description":"先生成公钥和私钥，在 Mac OSX 终端（或 iTerm 2 等）中进入 ~\/.ssh 目录，输入： $ ssh-keygen -t rsa 会询问一些问题，直接全部回车，即可在 ~\/.ssh 目录中生成 id_rsa（私钥） 和 id_rsa.pub（公钥）文件。我们需要将公钥上传到 testhost 服务器的 ~\/.ssh 目录下面，因为第二种方式中我们已经配置了 testhost 服务器，scp 也能识别这个服务器，所以，可以使用如下命令将文件传输到 testhost 服务器中： $ scp ~\/.ssh\/id_rsa.pub testhost:~\/.ssh\/ 接下来，用第二种方式登录到 testhost 服务器中，在 ~\/.ssh 目录中使用以下命令将 id_rsa.pub 更","inLanguage":"en-US","author":"Victor","creator":"Victor","publisher":"Victor","accountablePerson":"Victor","copyrightHolder":"Victor","copyrightYear":"2015","datePublished":"2015-07-18 13:04:01 \u002b0800 \u002b0800","dateModified":"2015-07-18 13:04:01 \u002b0800 \u002b0800","url":"https:\/\/maolu.one\/posts\/login-server-using-ssh-key-on-macos\/","keywords":[]}</script><title>macOS 使用 ssh key 登陆服务器 - 一间茅庐</title><meta property="og:title" content="macOS 使用 ssh key 登陆服务器 - 一间茅庐"><meta property="og:type" content="article"><meta property="og:description" content="先生成公钥和私钥，在 Mac OSX 终端（或 iTerm 2 等）中进入 ~/.ssh 目录，输入： $ ssh-keygen -t rsa 会询问一些问题，直接全部回车，即可在 ~/.ssh 目录中生成 id_rsa（私钥） 和 id_rsa.pub（公钥）文件。我们需要将公钥上传到 testhost 服务器的 ~/.ssh 目录下面，因为第二种方式中我们已经配置了 testhost 服务器，scp 也能识别这个服务器，所以，可以使用如下命令将文件传输到 testhost 服务器中： $ scp ~/.ssh/id_rsa.pub testhost:~/.ssh/ 接下来，用第二种方式登录到 testhost 服务器中，在 ~/.ssh 目录中使用以下命令将 id_rsa.pub 更"><meta name=description content="先生成公钥和私钥，在 Mac OSX 终端（或 iTerm 2 等）中进入 ~/.ssh 目录，输入： $ ssh-keygen -t rsa 会询问一些问题，直接全部回车，即可在 ~/.ssh 目录中生成 id_rsa（私钥） 和 id_rsa.pub（公钥）文件。我们需要将公钥上传到 testhost 服务器的 ~/.ssh 目录下面，因为第二种方式中我们已经配置了 testhost 服务器，scp 也能识别这个服务器，所以，可以使用如下命令将文件传输到 testhost 服务器中： $ scp ~/.ssh/id_rsa.pub testhost:~/.ssh/ 接下来，用第二种方式登录到 testhost 服务器中，在 ~/.ssh 目录中使用以下命令将 id_rsa.pub 更"><meta property="og:locale" content="zh-CN"><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/highlight/tomorrow.min.css><link rel=stylesheet href=/css/index.css><link href=/index.xml rel=alternate type=application/rss+xml title=一间茅庐><link href="https://fonts.googleapis.com/css?family=Arvo|Permanent+Marker|Bree+Serif" rel=stylesheet></head><body><article class=post id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class="signatures site-title"><a href=/>maolu.one</a></div></header><div class=header-line></div></div><header class=post-header><h1 class=post-title>macOS 使用 ssh key 登陆服务器</h1><div class="row post-desc"><div class=col-xs-6><b><em>Victor @</em></b>
<time class=post-date datetime="2015-07-18 13:04:01 +0800">18 Jul 2015</time></div><div class=col-xs-6></div></div></header><div class="post-content markdown-body"><p>先生成公钥和私钥，在 Mac OSX 终端（或 iTerm 2 等）中进入 ~/.ssh 目录，输入：</p><pre><code>$ ssh-keygen -t rsa
</code></pre><p>会询问一些问题，直接全部回车，即可在 ~/.ssh 目录中生成 id_rsa（私钥） 和 id_rsa.pub（公钥）文件。我们需要将公钥上传到 testhost 服务器的 ~/.ssh 目录下面，因为第二种方式中我们已经配置了 testhost 服务器，scp 也能识别这个服务器，所以，可以使用如下命令将文件传输到 testhost 服务器中：</p><pre><code>$ scp ~/.ssh/id_rsa.pub testhost:~/.ssh/
</code></pre><p>接下来，用第二种方式登录到 testhost 服务器中，在 ~/.ssh 目录中使用以下命令将 id_rsa.pub 更名为 authorized_keys：</p><pre><code>$ mv id_rsa.pub authorized_keys
</code></pre><p>最后确保下文件权限正常：</p><pre><code>$ chmod 700 ~/.ssh/
$ chmod 600 ~/.ssh/authorized_keys
</code></pre><p>现在，我们可以在 Mac OSX 的终端中使用 ssh testhost 登录到 testhost 服务器了，无需输入密码，更无需记忆服务器参数。</p><p>如果无法连接，请在服务器的 /etc/ssh/sshd_config 文件中查看 PubkeyAuthentication 的值是否为 yes，如果不是，请修改为 yes ，并使用以下命令重启 ssh 服务：</p><pre><code>$ /etc/init.d/ssh restart
</code></pre><p>如果需要禁止密码登录，同样可以编辑 <em><strong>/etc/ssh/sshd_config</strong></em> 文件中 <em><strong>PasswordAuthentication</strong></em> 的值为 <em><strong>no</strong></em> 并 <em><strong>重启 ssh 服务</strong></em>。</p><p>CentOS 7 可能依然无法登陆，提示：Permission denied (publickey,gssapi-keyex,gssapi-with-mic)。解决方式：</p><pre><code>$ restorecon -r -vv ～/.ssh/authorized_keys 
</code></pre></div><div class="row middle-xs"><div class=col-xs-12><div class=post-category><a href=/categories/tech/>Tech</a></div></div></div><div class=row><div class=col-xs-12></div></div><div style=height:50px></div><div class=post-comments><div id=disqus_thread></div><script>window.addEventListener("load",()=>{(function(){var d=document,s=d.createElement("script");s.src="https://maolu.disqus.com/embed.js";s.setAttribute("data-timestamp",+new Date());(d.head||d.body).appendChild(s);})();});</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div><div class=site-footer><div class=site-footer-item><a href=https://movie.douban.com/people/victor_douban/ target=_blank>Douban</a></div><div class=site-footer-item><a href=https://t.me/vz_tg target=_blank>Telegram</a></div><div class=site-footer-item><a href=mailto:victor@maolu.one target=_blank>Email</a></div><div class=site-footer-item><a href=/index.xml target=_blank>RSS</a></div></div></div></div></article><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>